% SmartCard Project
% Adv. Security
% Fall 2013
% Matthew Monaco
% Andy Sayler

\documentclass[11pt, twocolumn]{article}
\usepackage[text={6.5in, 9in}, centering]{geometry}

\usepackage{epsfig}
\usepackage{url}
\usepackage{float}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{color}

\usepackage{hyperref}
\hypersetup{
    colorlinks,
    citecolor=black,
    filecolor=black,
    linkcolor=black,
    urlcolor=black
}

\newenvironment{packed_enum}{
\begin{enumerate}
  \setlength{\itemsep}{1pt}
  \setlength{\parskip}{0pt}
  \setlength{\parsep}{0pt}
}{\end{enumerate}}

\newenvironment{packed_item}{
\begin{itemize}
  \setlength{\itemsep}{1pt}
  \setlength{\parskip}{0pt}
  \setlength{\parsep}{0pt}
}{\end{itemize}}

\newenvironment{packed_desc}{
\begin{description}
  \setlength{\itemsep}{1pt}
  \setlength{\parskip}{0pt}
  \setlength{\parsep}{0pt}
}{\end{description}}

\begin{document}

\title{Using SmartCards for Public Key Cryptography}

\author{
  Matt Monaco \\ \texttt{matthew.monaco@colorado.edu} \and
  Andy Sayler \\ \texttt{andy.sayler@colorado.edu}
}

\date{\today}

\maketitle

\begin{abstract}
Public key cryptography and the OpenPGP protocol are technologies
which offer advantages in both security and convenience over symmetric
encryption systems and traditional authentication
schemes. Unfortunately, standard software-based OpenPGP stacks still
exhibit usability and security issues across a range of modern use
cases. To overcome these issues, SmartCard-based OpenPGP hardware
devices allow OpenPGP to be used by the layperson in fairly wide range
of settings from single sign on (SSO) to email security to physical
access in enterprise environments. SmartCard hardware can both
simplify and further secure the use of OpenPGP. However, OpenPGP
SmartCard hardware is still a niche market, mainly in large
enterprises. We believe the power and flexibility of OpenPGP should be
ubiquitous, replacing a multitude of disparate systems and protocols
used by individuals, businesses, and governments. Furthermore, we
believe the main hindrance to OpenPGP's widespread adoption is the
lack of fully featured and accessible hardware. In this paper, we
explore the current hardware offerings and their limitations. We
propose changes to existing hardware systems to make them more
accessible by the general use. Additionally, we explore the role
public key cryptography and OpenPGP might play given widespread
adoption.
\end{abstract}

\section{Introduction}
\label{sec:intro}

Public key cryptography systems form the basis of many of the 21st
century systems we rely on every day: from secure web commerce to
global financial transaction systems to remote access and
authentication. Public key cryptography systems are the foundation of
our ability to operate securely in a digital world. The most widely
used public key cryptography algorithms,
Diffie-Hellman~\cite{diffie1976} and RSA~\cite{rivest1978}, are used
in thousands of protocols enabling millions of
applications. Unfortunately, while widely deployed and understood in
technical circles, public-key cryptography and the benefits it can
provide are largely unknown or inaccessible to lay
users~\cite{whitten1999}.

OpenPGP~\cite{openpgp, rfc4880} is a standard for using public key
cryptography across a range of inter-operable applications. It
supports three core cryptographic operations: attestation (signing),
encryption/decryption, and authentication. The most common way to use
the OpenPGP standard is through a OpenPGP client
applications. GnuPG~\cite{gnupg} is a widely deployed open-source
Free-software OpenPGP client applications. Today OpenPGP best
practices include the following~\cite{matt-openpgp}:

\begin{packed_item}
\item{Algorithm:} RSA-based keys are generally the preferred
  encryption algorithm, supplanting the older DSA or ElGamel
  algorithms. Elliptic Curve algorithms are the up-and-coming
  encryption standard, and will likely eventually supplant RSA, but
  RSA remains the recommended standard at this time.
\item{Key Length:} Key lengths of 2048-bits and longer are generally
  considered secure today. 4096-bit keys are recommended for those
  concerned with attack by APT-level advisories.
\item{Sub Keys:} Instead of using a signal key for all OpenPGP
  operations, it is generally considered wiser to have a restrict
  master key that is sued to derive a series of sub0keys, dedicating a
  separate sub-key to each OpenPGP operation. This allows the user to
  separate their reputation (assisted with the master key) from the
  actual keys they use on a day-to-day basis, making it easier to
  revoke and re-generate a specific sub-key in the event that is is
  compromised without having to rebuild their entire OpenPGP
  reputation.
\end{packed_item}

One of the key challenges in any cryptography system, including public
key cryptography systems, is where and how to securely store secret
keys. The security of cryptography systems is only as good as the
security of the associated key storage systems. Traditional key
storage practices include simply storing secret keys on the computer
on which they were generated, often protected by a user-specified
password. Such storage practice have several issues:

\begin{packed_item}
\item Keys are susceptible to compromise in the event the device on
  which they are stored is stolen.
\item Keys are susceptible to compromise from malicious programs
  running on the device on which they are stored.
\item Even keys protected with password are prone to brute force
  password attacks that will often succeed given sufficient time and
  computing power.
\item Keys are inaccessible on multiple devices (fairly common in
  modern day mobile-device centered use-cases).
\item Keys are inaccessible in situations where the storage device is
  inaccessible or shutdown.
\end{packed_item}

To overcome these limitations, OpenPGP allows for the use of secure
SmartCard-based key-storage hardware. An OpenPGP SmartCard provides
the following benefits over ad-hoc software-based key-storage:

\begin{packed_desc}
\item{Physical Security:} SmartCards contain physical security
  measures to protect their computing and storage elements. Such
  measures strive to grantee either the physical security or the
  complete destruction of all data stored on the device, providing
  protection in the event that a SmartCard is lost or stolen.
\item{Digital Security:} SmartCards are designed to never allow the
  key's stored on them to be transferred off the card. Thus, even
  malicious applications can not extract keys from SmartCards.
\item{Brute-Force Defenses:} SmartCard-stored keys are generally
  protected with passwords or PINs similar to software-based key
  storage. SmartCards, however, are generally programmed to erase
  their one-board storage in the event of a user interfacing more than
  N incorrect password attempts. This greatly limits the ability to
  conduct brute-force attacks on key-protection passwords without
  destroying the key in the process.
\item{Portability:} Since a SmartCard is a stand-alone storage device,
  it can be moved between multiple computing devises, proving
  controlled access to OpenPGP keys across a range of locations.
\item{On-Board Crypto:} SmartCards contain on-board cryptographic
  processors capable of performing most cryptographic operations
  on-card. This limiters the need to trust the cryptographic software
  on the machine on which the SmartCard is used.
\end{packed_desc}

Public key cryptography has the potential to provide the One True
Way\texttrademark in the world of digital attestation, encryption, and
authentication. Furthermore, these three core public key cryptography
capabilities can be leveraged to replace traditional non-secure
systems like everyday front door locks or education credentials
(\S\ref{sec:future}, adding both security and ease of use over the
existing solutions. In order for such ubiquitous public key
cryptography uses to come to fruition we must provide simple and
secure methods of storing and accessing public key cryptography
primitives like keys and IDs. SmartCards provide a hardware-based
mechanism for proving this simple and secure storage base.

\section{Existing Systems}
\label{sec:exisitng}

\section{Toward an Ideal Card}
\label{sec:ideal}

\subsection{Interface}

There are two interfaces which can be supported by the same device in order for
it to be used in just about any setting: USB and NFC.

USB is already an ubiquitous interfaces found on the full range of devices from
PCs and laptops to cell phones and watches. The USB CCID specification lets a
device act as combined SmartCard and SmartCard reader. This is an improvement
over separate cards and readers as the latter is specialized hardware which is
only somewhat common on business-grade laptops.

NFC is becoming increasing popular as an interface on smart phones as well as
point-of-sale terminals for reading credit card information. It provides an
added convenience because the user only needs to swipe a token passed a reader
rather than plugging it in. This convenience, however, comes with slightly
reduced security. It is possible to scan NFC tokens without a user's consent. We
propose a solution to this below, however the risk can be mitigated by metallic
covers.

\subsection{Capacity}

\subsection{Physical Security}

\subsection{Cost}

\subsection{Auxiliary Storage}

\section{Future Applications}
\label{sec:future}

There are many real-world applications which can \textit{technically} be
replaced or augmented by a \textit{more secure} public key based system. A fully
capable OpenPGP SmartCard however, can enable this \textit{in practice}. Such a
card will enable people to use public key cryptography throughout their
day-to-day lives.

\subsection{Certificates}

A certificate is a document cryptographically signed by a trusted party.
Cryptographic certificates can be used in place of many physical documents such
as birth certificates, diplomas, deeds to houses, auto titles, etc.

For example, a marriage license is a simple text document containing the
information found on a traditional marriage license.

\begin{verbatim}
GROOM=Bob
BRIDE=Alice
MUNICIPALITY=Boulder
STATE=Colorado
DATE=1970-01-01 00:00:00 +000
OFFICIANT=Little Bobby Tables
\end{verbatim}

The file is then cryptographically signed by the bride, groom, officiant, and
local marriage office using their respective SmartCard (or equivalent)
public-key hardware. The signed document is then stored in various places such
as the marriage office, the couple's personal storage, etc.

\subsection{Driver's Licenses}

Licenses in general are simply certificates, however a driver's license
in particular is worth discussing because it is a certificate that most people
are used to carrying at all times and displaying to people as
photo-identification for various reasons.

A cryptographic driver's license can be carried on the ideal SmartCard and
shared with others when appropriate. The license includes a certificate in the
same vain as the marriage license (above) and the signature of the states' motor
vehicle administration endorsing the holder's ability to drive. A police officer
inspecting the license will have a trusted copy of the keys of the motor vehicle
administration and can instantaneously verify any license.

\subsection{Identification}

We typically use our driver's licenses as visual identification, but in an
ubiquitous world of public key cryptography and SmartCards the infrastructure
for setting up trusted parties and new certification systems is very small. A
local authority should sign an image of its residents, but not necessarily the
\textit{motor vehicle} administration.

Like a driver's license, a person stores a signed photo (or multiple photos) of
herself on a SmartCard so that she can quickly prove that she is the rightful
holder of said SmartCard.

\subsection{Physical Access}

Physical access through doorways is already protected by security tokens in high
security environments. However gaining access to the home, child-safe rooms, etc
is more secure and more convenient with a SmartCard using near field
communication. There are already some high-tech security products entering the
market for the general population, but they are not as powerful as they would be
in an environment were we assume everyone is carrying a fully capable SmartCard.

Furthermore, using SmartCards for physical access as the norm implies that
everyone has their own key to the same door. Therefore, a home owner can
\textit{e.g.}, authorize a serviceman to enter her home and audit exactly when
he did so.

\subsection{Automobiles}

A often used physical access key is a car key. A SmartCard for entering and
starting a car is not just more secure and convenient for individuals. It is
also a way to lend your car to a friend for a specific period of time, or on
some fixed schedule. With an ubiquitous public key infrastructure, a car owner
can authorize the public key of another without exchanging secret information.

\subsection{Transactions}

In addition to certification and authentication, SmartCards can and should be
used for transactions at both online and brick-and-mortar stores. A customer is
presented with receipt describing the items and prices of the transaction,
ideally on her own, trusted device and signs it to complete the transaction. A
trusted intermediary -- a bank -- receives a transaction which is signed by two
parties and performs the agreed upon transfer. Consumers can then be far less
worried about incorrect and bogus charges on their monthly statement because
they cryptographically signed off on every transaction.

\section{Conclusion}
\label{sec:conclusion}

We have presented a model for an ideal SmartCard. It is capable of storing
multiple RSA and/or ECDSA keys of 4096 (or more) bits, has both USB CCID and
NFC interfaces, is resistant to physical tempering, and is able to store small
amounts of signed data. Such a card is sufficient to replace the many documents,
credit cards and keys we manage in our day-to-day lives in a more secure
\textit{and} more convenient manor.

\bibliographystyle{plain}
\nocite{*}
\bibliography{refs}

\end{document}

%%  LocalWords:  SmartCards SSO Diffie DSA ElGamel PINs
